import{compareDay,getMonthEndDay}from"../../util";import*as config from"../../config";Component({data:{days:[]},properties:{minDate:{optionalTypes:[Object,String]},maxDate:{optionalTypes:[Object,String]},formatter:{type:null,observer:"setDays"},date:{type:null,observer:"setDays"},currentDate:{optionalTypes:[Array],observer(){this.setDays()}},type:{type:String,observer:"setDays"},showMonthTitle:Boolean,color:{type:String,value:""}},methods:{onClick(t){const{item:e}=t.currentTarget.dataset;"disabled"!==e.type&&"empty"!==e.type&&this.triggerEvent("clickDay",e)},debounce(t){let e;return()=>{let a=this,r=arguments;e&&clearTimeout(e),e=setTimeout((function(){t.apply(a,r)}),300)}},setDays(){this.debounce(this.setDay)()},setDay(){let t=[];const e=new Date(this.data.date),a=e.getFullYear(),r=e.getMonth(),o=new Date(a,r,1).getDay(),n=getMonthEndDay(a,r+1);for(let e=1;e<=n;e++){const o=new Date(a,r,e).getTime(),n=this.getDayType(o);let s={date:o,type:n,text:e,bottomInfo:this.getBottomInfo(n),topInfo:""};this.data.formatter&&(s=this.data.formatter(s)),t.push(s)}for(let e=0;e<o;e++)t.unshift({type:"empty"});this.setData({days:t})},isDateInCurrent(t){const{currentDate:e}=this.data;return e.some(e=>0===compareDay(e,t))},getMultipleDayType(t){const{currentDate:e}=this.data;return Array.isArray(e)&&this.isDateInCurrent(t)?"selected":""},getRangeDayType(t){const{currentDate:e}=this.data;if(!Array.isArray(e))return;const[a,r]=e;if(!a)return;const o=compareDay(t,a);if(!r)return 0===o?"start":"";const n=compareDay(t,r);return 0===o?"start":0===n?"end":o>0&&n<0?"middle":void 0},getDayType(t){const{type:e,minDate:a,maxDate:r,currentDate:o}=this.data;return compareDay(t,a)<0||compareDay(t,r)>0?"disabled":e===config.TYPE_SINGLE?0===compareDay(t,o)?"selected":"":e===config.TYPE_MULTIPLE?this.getMultipleDayType(t):e===config.TYPE_RANGE?this.getRangeDayType(t):void 0},getBottomInfo(t){return this.data.type===config.TYPE_RANGE?"start"===t?"开始":"end"===t?"结束":"":""}}});